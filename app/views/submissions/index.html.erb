<div class="row">
  <div class="col-sm">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3">
      <h1 class="h2">Submissions</h1>
    </div>
  </div>
</div>
<div class="row mb-3">
  <div class="col-6">
    <%= form_tag(submissions_path, method: :get, class: 'form-inline') do %>
      
      <div class="form-group">
        <small class="form-text text-muted">
          Sort by
        </small>
        <% if current_user.is_super_admin? || current_user.is_admin? %>
          <%= select_tag :sort_field, options_for_select([['Created At', 'created_at'],
                                                    ['Company Name', 'company_name'],
                                                    ['Seller Name', 'seller_name'],
                                                    ['Quantity', 'quantity'],
                                                    ['Isbn', 'isbn'],
                                                    ['Status', 'status'],
                                                    ['Counterfeits', 'counterfeits'],
                                                    ['Source Name', 'source_name'],
                                                    ['Source Address', 'source_address'],
                                                    ['Source Phone', 'source_phone'],
                                                    ['Source Email', 'source_email'],
                                                    ['Notes', 'notes'],
                                                    ['Approved', 'approved']],
                                                    params[:sort_field]), class: 'form-control m-2' %>
        
          <%= select_tag :approved, options_for_select(
            [true,false],params[:approved]), include_blank: "Approved", class: 'form-control m-2' %>
        <% end %>
        <%= text_field_tag :search_term, params[:search_term], placeholder: 'Search', class: 'form-control m-2' %>
        <%= submit_tag 'Submit', class: 'btn btn-primary m-2' %>
        <%= submit_tag 'Export', class: 'btn btn-secondary m-2' %>
      </div>
    <% end %>
  </div>
  <div class="col-6">
    <div class="btn-toolbar float-right">
      <div class="btn-group mr-2">
        <%= link_to new_submission_path, class: 'btn btn-secondary m-2' do %>
          <span class="fa fa-plus"></span>
          New
        <% end %>
      </div>
    </div>
  </div>
</div>

<table class="table table-bordered">
  <thead class="thead-light">
    <tr>
      <% if current_user.is_super_admin? || current_user.is_admin? %>
        <th>Company</th>
        <th>Seller Name</th>
        <th>Quantity</th>
        <th>Isbn</th>
        <th>Status</th>
        <th>Counterfeits</th>
        <th>Source Name</th>
        <th>Source Address</th>
        <th>Source Phone</th>
        <th>Source Email</th>
        <th>Notes</th>
        <th>Approved</th>
        <th>Action</th>
      <% else %>
        <th>Company</th>
        <th>Seller Name</th>
        <th>Status</th>
        <th>Notes</th>
      <% end %>
    </tr>
  </thead>

  <tbody>
    <% unless @submissions.blank? %>
      <% @submissions.each do |submission| %>
        <tr>
          <% if current_user.is_super_admin? || current_user.is_admin? %>
            <td><%= submission.company_name %></td>
            <td><%= submission.seller_name %></td>
            <td><%= submission.quantity %></td>
            <td><%= submission.isbn %></td>
            <% if submission.status == 'Blacklisted' %>
              <td class="text-danger"><%= submission.status %></td>
            <% elsif submission.status == 'Whitelisted' %>
              <td class="text-success"><%= submission.status %></td>
            <% else %>
              <td class="text-warning"><%= submission.status %></td>
            <% end %>
            <td><%= submission.counterfeits %></td>
            <td><%= submission.source_name %></td>
            <td><%= submission.source_address %></td>
            <td><%= submission.source_phone %></td>
            <td><%= submission.source_email %></td>
            <td><%= submission.notes %></td>
            <td><%= submission.approved %></td>
            <td>
              <%= link_to submission, class: 'btn btn-light btn-sm', type: 'button' do %>
                <span class="fa fa-search-plus"></span>
                Show
              <% end %>
              <%= link_to edit_submission_path(submission), class: 'btn btn-light btn-sm' do %>
                <span class="fa fa-file"></span>
                Edit
              <% end %>
              <%= link_to submission, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-light btn-sm' do %>
                <span class="fa fa-trash"></span>
                Delete
              <% end %>
            </td>
          <% else %>
            <td><%= submission.company_name %></td>
            <td><%= submission.seller_name %></td>
            <% if submission.status == 'Blacklisted' %>
              <td class="text-danger"><%= submission.status %></td>
            <% elsif submission.status == 'Whitelisted' %>
              <td class="text-success"><%= submission.status %></td>
            <% else %>
              <td class="text-warning"><%= submission.status %></td>
            <% end %>
            <td><%= submission.notes %></td>
          <% end %>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>
<%= will_paginate @submissions %>
<br>